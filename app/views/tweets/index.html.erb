<h1>ツイート一覧です</h1>

<% @tweets.each do |tweet| %>
  <hr>
  <p><span>email: </span><%=link_to tweet.user.email, user_path(tweet.user.id) %></p>
  <p><span>ツイート内容: </span><%=link_to tweet.body, tweet_path(tweet.id) %></p>
  <% if tweet.img? %>
  <%= image_tag tweet.img.url %>>
  <% else %>
  <img src="/assets/default.png" class="icon" alt="ユーザーアイコン" %>
  <% end %>
  
  <% if user_signed_in? %>
    <% if tweet.favorited_by?(current_user) %> 
        <p><span>お気に入り解除: </span><%=link_to tweet.favorites.count, tweet_favorites_path(tweet.id), method: :delete %></p>
    <% else %>
        <p><span>お気に入り登録: </span><%=link_to tweet.favorites.count, tweet_favorites_path(tweet.id), method: :post %></p>
    <% end %>

    <% if current_user != tweet.user %>
        <% if tweet.user.followed_by?(current_user) %>
            <p><%=link_to "フォロー済み", user_relationships_path(tweet.user.id), method: :delete %></p>
        <% else %>
            <p><%=link_to "フォローする", user_relationships_path(tweet.user.id), method: :post %></p>
        <% end %>
    <% end %>
    
    <% if current_user == tweet.user %>
      <%= link_to "edit", edit_tweet_path(tweet[:id]) %>
      <%= link_to "delete", tweet, method: :delete, data: { confirm: "You sure?" } %>
    <% end %>

  <% else %>
    <p><span>お気に入り数: </span><%= tweet.favorites.count %></p>
  <% end %>

<% end %>